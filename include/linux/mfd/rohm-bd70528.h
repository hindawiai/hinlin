<शैली गुरु>
/* SPDX-License-Identअगरier: GPL-2.0-or-later */
/* Copyright (C) 2018 ROHM Semiconductors */

#अगर_अघोषित __LINUX_MFD_BD70528_H__
#घोषणा __LINUX_MFD_BD70528_H__

#समावेश <linux/bits.h>
#समावेश <linux/device.h>
#समावेश <linux/mfd/rohm-generic.h>
#समावेश <linux/mfd/rohm-shared.h>
#समावेश <linux/regmap.h>

क्रमागत अणु
	BD70528_BUCK1,
	BD70528_BUCK2,
	BD70528_BUCK3,
	BD70528_LDO1,
	BD70528_LDO2,
	BD70528_LDO3,
	BD70528_LED1,
	BD70528_LED2,
पूर्ण;

काष्ठा bd70528_data अणु
	काष्ठा rohm_regmap_dev chip;
	काष्ठा mutex rtc_समयr_lock;
पूर्ण;

#घोषणा BD70528_BUCK_VOLTS 0x10
#घोषणा BD70528_LDO_VOLTS 0x20

#घोषणा BD70528_REG_BUCK1_EN	0x0F
#घोषणा BD70528_REG_BUCK1_VOLT	0x15
#घोषणा BD70528_REG_BUCK2_EN	0x10
#घोषणा BD70528_REG_BUCK2_VOLT	0x16
#घोषणा BD70528_REG_BUCK3_EN	0x11
#घोषणा BD70528_REG_BUCK3_VOLT	0x17
#घोषणा BD70528_REG_LDO1_EN	0x1b
#घोषणा BD70528_REG_LDO1_VOLT	0x1e
#घोषणा BD70528_REG_LDO2_EN	0x1c
#घोषणा BD70528_REG_LDO2_VOLT	0x1f
#घोषणा BD70528_REG_LDO3_EN	0x1d
#घोषणा BD70528_REG_LDO3_VOLT	0x20
#घोषणा BD70528_REG_LED_CTRL	0x2b
#घोषणा BD70528_REG_LED_VOLT	0x29
#घोषणा BD70528_REG_LED_EN	0x2a

/* मुख्य irq रेजिस्टरs */
#घोषणा BD70528_REG_INT_MAIN	0x7E
#घोषणा BD70528_REG_INT_MAIN_MASK 0x74

/* 'sub irq' रेजिस्टरs */
#घोषणा BD70528_REG_INT_SHDN	0x7F
#घोषणा BD70528_REG_INT_PWR_FLT	0x80
#घोषणा BD70528_REG_INT_VR_FLT	0x81
#घोषणा BD70528_REG_INT_MISC	0x82
#घोषणा BD70528_REG_INT_BAT1	0x83
#घोषणा BD70528_REG_INT_BAT2	0x84
#घोषणा BD70528_REG_INT_RTC	0x85
#घोषणा BD70528_REG_INT_GPIO	0x86
#घोषणा BD70528_REG_INT_OP_FAIL	0x87

#घोषणा BD70528_REG_INT_SHDN_MASK	0x75
#घोषणा BD70528_REG_INT_PWR_FLT_MASK	0x76
#घोषणा BD70528_REG_INT_VR_FLT_MASK	0x77
#घोषणा BD70528_REG_INT_MISC_MASK	0x78
#घोषणा BD70528_REG_INT_BAT1_MASK	0x79
#घोषणा BD70528_REG_INT_BAT2_MASK	0x7a
#घोषणा BD70528_REG_INT_RTC_MASK	0x7b
#घोषणा BD70528_REG_INT_GPIO_MASK	0x7c
#घोषणा BD70528_REG_INT_OP_FAIL_MASK	0x7d

/* Reset related 'magic' रेजिस्टरs */
#घोषणा BD70528_REG_SHIPMODE	0x03
#घोषणा BD70528_REG_HWRESET	0x04
#घोषणा BD70528_REG_WARMRESET	0x05
#घोषणा BD70528_REG_STANDBY	0x06

/* GPIO रेजिस्टरs */
#घोषणा BD70528_REG_GPIO_STATE	0x8F

#घोषणा BD70528_REG_GPIO1_IN	0x4d
#घोषणा BD70528_REG_GPIO2_IN	0x4f
#घोषणा BD70528_REG_GPIO3_IN	0x51
#घोषणा BD70528_REG_GPIO4_IN	0x53
#घोषणा BD70528_REG_GPIO1_OUT	0x4e
#घोषणा BD70528_REG_GPIO2_OUT	0x50
#घोषणा BD70528_REG_GPIO3_OUT	0x52
#घोषणा BD70528_REG_GPIO4_OUT	0x54

/* RTC */

#घोषणा BD70528_REG_RTC_COUNT_H		0x2d
#घोषणा BD70528_REG_RTC_COUNT_L		0x2e
#घोषणा BD70528_REG_RTC_SEC		0x2f
#घोषणा BD70528_REG_RTC_MINUTE		0x30
#घोषणा BD70528_REG_RTC_HOUR		0x31
#घोषणा BD70528_REG_RTC_WEEK		0x32
#घोषणा BD70528_REG_RTC_DAY		0x33
#घोषणा BD70528_REG_RTC_MONTH		0x34
#घोषणा BD70528_REG_RTC_YEAR		0x35

#घोषणा BD70528_REG_RTC_ALM_SEC		0x36
#घोषणा BD70528_REG_RTC_ALM_START	BD70528_REG_RTC_ALM_SEC
#घोषणा BD70528_REG_RTC_ALM_MINUTE	0x37
#घोषणा BD70528_REG_RTC_ALM_HOUR	0x38
#घोषणा BD70528_REG_RTC_ALM_WEEK	0x39
#घोषणा BD70528_REG_RTC_ALM_DAY		0x3a
#घोषणा BD70528_REG_RTC_ALM_MONTH	0x3b
#घोषणा BD70528_REG_RTC_ALM_YEAR	0x3c
#घोषणा BD70528_REG_RTC_ALM_MASK	0x3d
#घोषणा BD70528_REG_RTC_ALM_REPEAT	0x3e
#घोषणा BD70528_REG_RTC_START		BD70528_REG_RTC_SEC

#घोषणा BD70528_REG_RTC_WAKE_SEC	0x43
#घोषणा BD70528_REG_RTC_WAKE_START	BD70528_REG_RTC_WAKE_SEC
#घोषणा BD70528_REG_RTC_WAKE_MIN	0x44
#घोषणा BD70528_REG_RTC_WAKE_HOUR	0x45
#घोषणा BD70528_REG_RTC_WAKE_CTRL	0x46

#घोषणा BD70528_REG_ELAPSED_TIMER_EN	0x42
#घोषणा BD70528_REG_WAKE_EN		0x46

/* WDT रेजिस्टरs */
#घोषणा BD70528_REG_WDT_CTRL		0x4A
#घोषणा BD70528_REG_WDT_HOUR		0x49
#घोषणा BD70528_REG_WDT_MINUTE		0x48
#घोषणा BD70528_REG_WDT_SEC		0x47

/* Charger / Battery */
#घोषणा BD70528_REG_CHG_CURR_STAT	0x59
#घोषणा BD70528_REG_CHG_BAT_STAT	0x57
#घोषणा BD70528_REG_CHG_BAT_TEMP	0x58
#घोषणा BD70528_REG_CHG_IN_STAT		0x56
#घोषणा BD70528_REG_CHG_DCIN_ILIM	0x5d
#घोषणा BD70528_REG_CHG_CHG_CURR_WARM	0x61
#घोषणा BD70528_REG_CHG_CHG_CURR_COLD	0x62

/* Masks क्रम मुख्य IRQ रेजिस्टर bits */
क्रमागत अणु
	BD70528_INT_SHDN,
#घोषणा BD70528_INT_SHDN_MASK BIT(BD70528_INT_SHDN)
	BD70528_INT_PWR_FLT,
#घोषणा BD70528_INT_PWR_FLT_MASK BIT(BD70528_INT_PWR_FLT)
	BD70528_INT_VR_FLT,
#घोषणा BD70528_INT_VR_FLT_MASK BIT(BD70528_INT_VR_FLT)
	BD70528_INT_MISC,
#घोषणा BD70528_INT_MISC_MASK BIT(BD70528_INT_MISC)
	BD70528_INT_BAT1,
#घोषणा BD70528_INT_BAT1_MASK BIT(BD70528_INT_BAT1)
	BD70528_INT_RTC,
#घोषणा BD70528_INT_RTC_MASK BIT(BD70528_INT_RTC)
	BD70528_INT_GPIO,
#घोषणा BD70528_INT_GPIO_MASK BIT(BD70528_INT_GPIO)
	BD70528_INT_OP_FAIL,
#घोषणा BD70528_INT_OP_FAIL_MASK BIT(BD70528_INT_OP_FAIL)
पूर्ण;

/* IRQs */
क्रमागत अणु
	/* Shutकरोwn रेजिस्टर IRQs */
	BD70528_INT_LONGPUSH,
	BD70528_INT_WDT,
	BD70528_INT_HWRESET,
	BD70528_INT_RSTB_FAULT,
	BD70528_INT_VBAT_UVLO,
	BD70528_INT_TSD,
	BD70528_INT_RSTIN,
	/* Power failure रेजिस्टर IRQs */
	BD70528_INT_BUCK1_FAULT,
	BD70528_INT_BUCK2_FAULT,
	BD70528_INT_BUCK3_FAULT,
	BD70528_INT_LDO1_FAULT,
	BD70528_INT_LDO2_FAULT,
	BD70528_INT_LDO3_FAULT,
	BD70528_INT_LED1_FAULT,
	BD70528_INT_LED2_FAULT,
	/* VR FAULT रेजिस्टर IRQs */
	BD70528_INT_BUCK1_OCP,
	BD70528_INT_BUCK2_OCP,
	BD70528_INT_BUCK3_OCP,
	BD70528_INT_LED1_OCP,
	BD70528_INT_LED2_OCP,
	BD70528_INT_BUCK1_FULLON,
	BD70528_INT_BUCK2_FULLON,
	/* PMU रेजिस्टर पूर्णांकerrupts */
	BD70528_INT_SHORTPUSH,
	BD70528_INT_AUTO_WAKEUP,
	BD70528_INT_STATE_CHANGE,
	/* Charger 1 रेजिस्टर IRQs */
	BD70528_INT_BAT_OV_RES,
	BD70528_INT_BAT_OV_DET,
	BD70528_INT_DBAT_DET,
	BD70528_INT_BATTSD_COLD_RES,
	BD70528_INT_BATTSD_COLD_DET,
	BD70528_INT_BATTSD_HOT_RES,
	BD70528_INT_BATTSD_HOT_DET,
	BD70528_INT_CHG_TSD,
	/* Charger 2 रेजिस्टर IRQs */
	BD70528_INT_BAT_RMV,
	BD70528_INT_BAT_DET,
	BD70528_INT_DCIN2_OV_RES,
	BD70528_INT_DCIN2_OV_DET,
	BD70528_INT_DCIN2_RMV,
	BD70528_INT_DCIN2_DET,
	BD70528_INT_DCIN1_RMV,
	BD70528_INT_DCIN1_DET,
	/* RTC रेजिस्टर IRQs */
	BD70528_INT_RTC_ALARM,
	BD70528_INT_ELPS_TIM,
	/* GPIO रेजिस्टर IRQs */
	BD70528_INT_GPIO0,
	BD70528_INT_GPIO1,
	BD70528_INT_GPIO2,
	BD70528_INT_GPIO3,
	/* Invalid operation रेजिस्टर IRQs */
	BD70528_INT_BUCK1_DVS_OPFAIL,
	BD70528_INT_BUCK2_DVS_OPFAIL,
	BD70528_INT_BUCK3_DVS_OPFAIL,
	BD70528_INT_LED1_VOLT_OPFAIL,
	BD70528_INT_LED2_VOLT_OPFAIL,
पूर्ण;

/* Masks */
#घोषणा BD70528_INT_LONGPUSH_MASK 0x1
#घोषणा BD70528_INT_WDT_MASK 0x2
#घोषणा BD70528_INT_HWRESET_MASK 0x4
#घोषणा BD70528_INT_RSTB_FAULT_MASK 0x8
#घोषणा BD70528_INT_VBAT_UVLO_MASK 0x10
#घोषणा BD70528_INT_TSD_MASK 0x20
#घोषणा BD70528_INT_RSTIN_MASK 0x40

#घोषणा BD70528_INT_BUCK1_FAULT_MASK 0x1
#घोषणा BD70528_INT_BUCK2_FAULT_MASK 0x2
#घोषणा BD70528_INT_BUCK3_FAULT_MASK 0x4
#घोषणा BD70528_INT_LDO1_FAULT_MASK 0x8
#घोषणा BD70528_INT_LDO2_FAULT_MASK 0x10
#घोषणा BD70528_INT_LDO3_FAULT_MASK 0x20
#घोषणा BD70528_INT_LED1_FAULT_MASK 0x40
#घोषणा BD70528_INT_LED2_FAULT_MASK 0x80

#घोषणा BD70528_INT_BUCK1_OCP_MASK 0x1
#घोषणा BD70528_INT_BUCK2_OCP_MASK 0x2
#घोषणा BD70528_INT_BUCK3_OCP_MASK 0x4
#घोषणा BD70528_INT_LED1_OCP_MASK 0x8
#घोषणा BD70528_INT_LED2_OCP_MASK 0x10
#घोषणा BD70528_INT_BUCK1_FULLON_MASK 0x20
#घोषणा BD70528_INT_BUCK2_FULLON_MASK 0x40

#घोषणा BD70528_INT_SHORTPUSH_MASK 0x1
#घोषणा BD70528_INT_AUTO_WAKEUP_MASK 0x2
#घोषणा BD70528_INT_STATE_CHANGE_MASK 0x10

#घोषणा BD70528_INT_BAT_OV_RES_MASK 0x1
#घोषणा BD70528_INT_BAT_OV_DET_MASK 0x2
#घोषणा BD70528_INT_DBAT_DET_MASK 0x4
#घोषणा BD70528_INT_BATTSD_COLD_RES_MASK 0x8
#घोषणा BD70528_INT_BATTSD_COLD_DET_MASK 0x10
#घोषणा BD70528_INT_BATTSD_HOT_RES_MASK 0x20
#घोषणा BD70528_INT_BATTSD_HOT_DET_MASK 0x40
#घोषणा BD70528_INT_CHG_TSD_MASK 0x80

#घोषणा BD70528_INT_BAT_RMV_MASK 0x1
#घोषणा BD70528_INT_BAT_DET_MASK 0x2
#घोषणा BD70528_INT_DCIN2_OV_RES_MASK 0x4
#घोषणा BD70528_INT_DCIN2_OV_DET_MASK 0x8
#घोषणा BD70528_INT_DCIN2_RMV_MASK 0x10
#घोषणा BD70528_INT_DCIN2_DET_MASK 0x20
#घोषणा BD70528_INT_DCIN1_RMV_MASK 0x40
#घोषणा BD70528_INT_DCIN1_DET_MASK 0x80

#घोषणा BD70528_INT_RTC_ALARM_MASK 0x1
#घोषणा BD70528_INT_ELPS_TIM_MASK 0x2

#घोषणा BD70528_INT_GPIO0_MASK 0x1
#घोषणा BD70528_INT_GPIO1_MASK 0x2
#घोषणा BD70528_INT_GPIO2_MASK 0x4
#घोषणा BD70528_INT_GPIO3_MASK 0x8

#घोषणा BD70528_INT_BUCK1_DVS_OPFAIL_MASK 0x1
#घोषणा BD70528_INT_BUCK2_DVS_OPFAIL_MASK 0x2
#घोषणा BD70528_INT_BUCK3_DVS_OPFAIL_MASK 0x4
#घोषणा BD70528_INT_LED1_VOLT_OPFAIL_MASK 0x10
#घोषणा BD70528_INT_LED2_VOLT_OPFAIL_MASK 0x20

#घोषणा BD70528_DEBOUNCE_MASK 0x3

#घोषणा BD70528_DEBOUNCE_DISABLE 0
#घोषणा BD70528_DEBOUNCE_15MS 1
#घोषणा BD70528_DEBOUNCE_30MS 2
#घोषणा BD70528_DEBOUNCE_50MS 3

#घोषणा BD70528_GPIO_DRIVE_MASK 0x2
#घोषणा BD70528_GPIO_PUSH_PULL 0x0
#घोषणा BD70528_GPIO_OPEN_DRAIN 0x2

#घोषणा BD70528_GPIO_OUT_EN_MASK 0x80
#घोषणा BD70528_GPIO_OUT_ENABLE 0x80
#घोषणा BD70528_GPIO_OUT_DISABLE 0x0

#घोषणा BD70528_GPIO_OUT_HI 0x1
#घोषणा BD70528_GPIO_OUT_LO 0x0
#घोषणा BD70528_GPIO_OUT_MASK 0x1

#घोषणा BD70528_GPIO_IN_STATE_BASE 1

/* RTC masks to mask out reserved bits */

#घोषणा BD70528_MASK_ELAPSED_TIMER_EN	0x1
/* Mask second, min and hour fields
 * HW would support ALM irq क्रम over 24h
 * (by setting day, month and year too)
 * but as we wish to keep this same as क्रम
 * wake-up we limit ALM to 24H and only
 * unmask sec, min and hour
 */
#घोषणा BD70528_MASK_WAKE_EN		0x1

/* WDT masks */
#घोषणा BD70528_MASK_WDT_EN		0x1
#घोषणा BD70528_MASK_WDT_HOUR		0x1
#घोषणा BD70528_MASK_WDT_MINUTE		0x7f
#घोषणा BD70528_MASK_WDT_SEC		0x7f

#घोषणा BD70528_WDT_STATE_BIT		0x1
#घोषणा BD70528_ELAPSED_STATE_BIT	0x2
#घोषणा BD70528_WAKE_STATE_BIT		0x4

/* Charger masks */
#घोषणा BD70528_MASK_CHG_STAT		0x7f
#घोषणा BD70528_MASK_CHG_BAT_TIMER	0x20
#घोषणा BD70528_MASK_CHG_BAT_OVERVOLT	0x10
#घोषणा BD70528_MASK_CHG_BAT_DETECT	0x1
#घोषणा BD70528_MASK_CHG_DCIN1_UVLO	0x1
#घोषणा BD70528_MASK_CHG_DCIN_ILIM	0x3f
#घोषणा BD70528_MASK_CHG_CHG_CURR	0x1f
#घोषणा BD70528_MASK_CHG_TRICKLE_CURR	0x10

/*
 * Note, बाह्यal battery रेजिस्टर is the lonely rider at
 * address 0xc5. See how to stuff that in the regmap
 */
#घोषणा BD70528_MAX_REGISTER 0x94

/* Buck control masks */
#घोषणा BD70528_MASK_RUN_EN	0x4
#घोषणा BD70528_MASK_STBY_EN	0x2
#घोषणा BD70528_MASK_IDLE_EN	0x1
#घोषणा BD70528_MASK_LED1_EN	0x1
#घोषणा BD70528_MASK_LED2_EN	0x10

#घोषणा BD70528_MASK_BUCK_VOLT	0xf
#घोषणा BD70528_MASK_LDO_VOLT	0x1f
#घोषणा BD70528_MASK_LED1_VOLT	0x1
#घोषणा BD70528_MASK_LED2_VOLT	0x10

/* Misc irq masks */
#घोषणा BD70528_INT_MASK_SHORT_PUSH	1
#घोषणा BD70528_INT_MASK_AUTO_WAKE	2
#घोषणा BD70528_INT_MASK_POWER_STATE	4

#घोषणा BD70528_MASK_BUCK_RAMP 0x10
#घोषणा BD70528_SIFT_BUCK_RAMP 4

#अगर IS_ENABLED(CONFIG_BD70528_WATCHDOG)

पूर्णांक bd70528_wdt_set(काष्ठा rohm_regmap_dev *data, पूर्णांक enable, पूर्णांक *old_state);
व्योम bd70528_wdt_lock(काष्ठा rohm_regmap_dev *data);
व्योम bd70528_wdt_unlock(काष्ठा rohm_regmap_dev *data);

#अन्यथा /* CONFIG_BD70528_WATCHDOG */

अटल अंतरभूत पूर्णांक bd70528_wdt_set(काष्ठा rohm_regmap_dev *data, पूर्णांक enable,
				  पूर्णांक *old_state)
अणु
	वापस 0;
पूर्ण

अटल अंतरभूत व्योम bd70528_wdt_lock(काष्ठा rohm_regmap_dev *data)
अणु
पूर्ण

अटल अंतरभूत व्योम bd70528_wdt_unlock(काष्ठा rohm_regmap_dev *data)
अणु
पूर्ण

#पूर्ण_अगर /* CONFIG_BD70528_WATCHDOG */

#पूर्ण_अगर /* __LINUX_MFD_BD70528_H__ */
