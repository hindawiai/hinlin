<शैली गुरु>
// SPDX-License-Identअगरier: GPL-2.0-or-later
/*
 * SN9C2028 library
 *
 * Copyright (C) 2009 Theoकरोre Kilgore <kilgota@auburn.edu>
 */

#घोषणा pr_fmt(fmt) KBUILD_MODNAME ": " fmt

#घोषणा MODULE_NAME "sn9c2028"

#समावेश "gspca.h"

MODULE_AUTHOR("Theodore Kilgore");
MODULE_DESCRIPTION("Sonix SN9C2028 USB Camera Driver");
MODULE_LICENSE("GPL");

/* specअगरic webcam descriptor */
काष्ठा sd अणु
	काष्ठा gspca_dev gspca_dev;  /* !! must be the first item */
	u8 sof_पढ़ो;
	u16 model;

#घोषणा MIN_AVG_LUM 8500
#घोषणा MAX_AVG_LUM 10000
	पूर्णांक avg_lum;
	u8 avg_lum_l;

	काष्ठा अणु /* स्वतःgain and gain control cluster */
		काष्ठा v4l2_ctrl *स्वतःgain;
		काष्ठा v4l2_ctrl *gain;
	पूर्ण;
पूर्ण;

काष्ठा init_command अणु
	अचिन्हित अक्षर inकाष्ठाion[6];
	अचिन्हित अक्षर to_पढ़ो; /* length to पढ़ो. 0 means no reply requested */
पूर्ण;

/* How to change the resolution of any of the VGA cams is unknown */
अटल स्थिर काष्ठा v4l2_pix_क्रमmat vga_mode[] = अणु
	अणु640, 480, V4L2_PIX_FMT_SN9C2028, V4L2_FIELD_NONE,
		.bytesperline = 640,
		.sizeimage = 640 * 480 * 3 / 4,
		.colorspace = V4L2_COLORSPACE_SRGB,
		.priv = 0पूर्ण,
पूर्ण;

/* No way to change the resolution of the CIF cams is known */
अटल स्थिर काष्ठा v4l2_pix_क्रमmat cअगर_mode[] = अणु
	अणु352, 288, V4L2_PIX_FMT_SN9C2028, V4L2_FIELD_NONE,
		.bytesperline = 352,
		.sizeimage = 352 * 288 * 3 / 4,
		.colorspace = V4L2_COLORSPACE_SRGB,
		.priv = 0पूर्ण,
पूर्ण;

/* the bytes to ग_लिखो are in gspca_dev->usb_buf */
अटल पूर्णांक sn9c2028_command(काष्ठा gspca_dev *gspca_dev, u8 *command)
अणु
	पूर्णांक rc;

	gspca_dbg(gspca_dev, D_USBO, "sending command %02x%02x%02x%02x%02x%02x\n",
		  command[0], command[1], command[2],
		  command[3], command[4], command[5]);

	स_नकल(gspca_dev->usb_buf, command, 6);
	rc = usb_control_msg(gspca_dev->dev,
			usb_sndctrlpipe(gspca_dev->dev, 0),
			USB_REQ_GET_CONFIGURATION,
			USB_सूची_OUT | USB_TYPE_VENDOR | USB_RECIP_INTERFACE,
			2, 0, gspca_dev->usb_buf, 6, 500);
	अगर (rc < 0) अणु
		pr_err("command write [%02x] error %d\n",
		       gspca_dev->usb_buf[0], rc);
		वापस rc;
	पूर्ण

	वापस 0;
पूर्ण

अटल पूर्णांक sn9c2028_पढ़ो1(काष्ठा gspca_dev *gspca_dev)
अणु
	पूर्णांक rc;

	rc = usb_control_msg(gspca_dev->dev,
			usb_rcvctrlpipe(gspca_dev->dev, 0),
			USB_REQ_GET_STATUS,
			USB_सूची_IN | USB_TYPE_VENDOR | USB_RECIP_INTERFACE,
			1, 0, gspca_dev->usb_buf, 1, 500);
	अगर (rc != 1) अणु
		pr_err("read1 error %d\n", rc);
		वापस (rc < 0) ? rc : -EIO;
	पूर्ण
	gspca_dbg(gspca_dev, D_USBI, "read1 response %02x\n",
		  gspca_dev->usb_buf[0]);
	वापस gspca_dev->usb_buf[0];
पूर्ण

अटल पूर्णांक sn9c2028_पढ़ो4(काष्ठा gspca_dev *gspca_dev, u8 *पढ़ोing)
अणु
	पूर्णांक rc;
	rc = usb_control_msg(gspca_dev->dev,
			usb_rcvctrlpipe(gspca_dev->dev, 0),
			USB_REQ_GET_STATUS,
			USB_सूची_IN | USB_TYPE_VENDOR | USB_RECIP_INTERFACE,
			4, 0, gspca_dev->usb_buf, 4, 500);
	अगर (rc != 4) अणु
		pr_err("read4 error %d\n", rc);
		वापस (rc < 0) ? rc : -EIO;
	पूर्ण
	स_नकल(पढ़ोing, gspca_dev->usb_buf, 4);
	gspca_dbg(gspca_dev, D_USBI, "read4 response %02x%02x%02x%02x\n",
		  पढ़ोing[0], पढ़ोing[1], पढ़ोing[2], पढ़ोing[3]);
	वापस rc;
पूर्ण

अटल पूर्णांक sn9c2028_दीर्घ_command(काष्ठा gspca_dev *gspca_dev, u8 *command)
अणु
	पूर्णांक i, status;
	__u8 पढ़ोing[4];

	status = sn9c2028_command(gspca_dev, command);
	अगर (status < 0)
		वापस status;

	status = -1;
	क्रम (i = 0; i < 256 && status < 2; i++)
		status = sn9c2028_पढ़ो1(gspca_dev);
	अगर (status < 0) अणु
		pr_err("long command status read error %d\n", status);
		वापस status;
	पूर्ण

	स_रखो(पढ़ोing, 0, 4);
	status = sn9c2028_पढ़ो4(gspca_dev, पढ़ोing);
	अगर (status < 0)
		वापस status;

	/* in general, the first byte of the response is the first byte of
	 * the command, or'ed with 8 */
	status = sn9c2028_पढ़ो1(gspca_dev);
	अगर (status < 0)
		वापस status;

	वापस 0;
पूर्ण

अटल पूर्णांक sn9c2028_लघु_command(काष्ठा gspca_dev *gspca_dev, u8 *command)
अणु
	पूर्णांक err_code;

	err_code = sn9c2028_command(gspca_dev, command);
	अगर (err_code < 0)
		वापस err_code;

	err_code = sn9c2028_पढ़ो1(gspca_dev);
	अगर (err_code < 0)
		वापस err_code;

	वापस 0;
पूर्ण

/* this function is called at probe समय */
अटल पूर्णांक sd_config(काष्ठा gspca_dev *gspca_dev,
		     स्थिर काष्ठा usb_device_id *id)
अणु
	काष्ठा sd *sd = (काष्ठा sd *) gspca_dev;
	काष्ठा cam *cam = &gspca_dev->cam;

	gspca_dbg(gspca_dev, D_PROBE, "SN9C2028 camera detected (vid/pid 0x%04X:0x%04X)\n",
		  id->idVenकरोr, id->idProduct);

	sd->model = id->idProduct;

	चयन (sd->model) अणु
	हाल 0x7005:
		gspca_dbg(gspca_dev, D_PROBE, "Genius Smart 300 camera\n");
		अवरोध;
	हाल 0x7003:
		gspca_dbg(gspca_dev, D_PROBE, "Genius Videocam Live v2\n");
		अवरोध;
	हाल 0x8000:
		gspca_dbg(gspca_dev, D_PROBE, "DC31VC\n");
		अवरोध;
	हाल 0x8001:
		gspca_dbg(gspca_dev, D_PROBE, "Spy camera\n");
		अवरोध;
	हाल 0x8003:
		gspca_dbg(gspca_dev, D_PROBE, "CIF camera\n");
		अवरोध;
	हाल 0x8008:
		gspca_dbg(gspca_dev, D_PROBE, "Mini-Shotz ms-350 camera\n");
		अवरोध;
	हाल 0x800a:
		gspca_dbg(gspca_dev, D_PROBE, "Vivitar 3350b type camera\n");
		cam->input_flags = V4L2_IN_ST_VFLIP | V4L2_IN_ST_HFLIP;
		अवरोध;
	पूर्ण

	चयन (sd->model) अणु
	हाल 0x8000:
	हाल 0x8001:
	हाल 0x8003:
		cam->cam_mode = cअगर_mode;
		cam->nmodes = ARRAY_SIZE(cअगर_mode);
		अवरोध;
	शेष:
		cam->cam_mode = vga_mode;
		cam->nmodes = ARRAY_SIZE(vga_mode);
	पूर्ण
	वापस 0;
पूर्ण

/* this function is called at probe and resume समय */
अटल पूर्णांक sd_init(काष्ठा gspca_dev *gspca_dev)
अणु
	पूर्णांक status;

	sn9c2028_पढ़ो1(gspca_dev);
	sn9c2028_पढ़ो1(gspca_dev);
	status = sn9c2028_पढ़ो1(gspca_dev);

	वापस (status < 0) ? status : 0;
पूर्ण

अटल पूर्णांक run_start_commands(काष्ठा gspca_dev *gspca_dev,
			      काष्ठा init_command *cam_commands, पूर्णांक n)
अणु
	पूर्णांक i, err_code = -1;

	क्रम (i = 0; i < n; i++) अणु
		चयन (cam_commands[i].to_पढ़ो) अणु
		हाल 4:
			err_code = sn9c2028_दीर्घ_command(gspca_dev,
					cam_commands[i].inकाष्ठाion);
			अवरोध;
		हाल 1:
			err_code = sn9c2028_लघु_command(gspca_dev,
					cam_commands[i].inकाष्ठाion);
			अवरोध;
		हाल 0:
			err_code = sn9c2028_command(gspca_dev,
					cam_commands[i].inकाष्ठाion);
			अवरोध;
		पूर्ण
		अगर (err_code < 0)
			वापस err_code;
	पूर्ण
	वापस 0;
पूर्ण

अटल व्योम set_gain(काष्ठा gspca_dev *gspca_dev, s32 g)
अणु
	काष्ठा sd *sd = (काष्ठा sd *) gspca_dev;

	काष्ठा init_command genius_vcam_live_gain_cmds[] = अणु
		अणुअणु0x1d, 0x25, 0x10 /* This byte is gain */,
		  0x20, 0xab, 0x00पूर्ण, 0पूर्ण,
	पूर्ण;
	अगर (!gspca_dev->streaming)
		वापस;

	चयन (sd->model) अणु
	हाल 0x7003:
		genius_vcam_live_gain_cmds[0].inकाष्ठाion[2] = g;
		run_start_commands(gspca_dev, genius_vcam_live_gain_cmds,
				   ARRAY_SIZE(genius_vcam_live_gain_cmds));
		अवरोध;
	शेष:
		अवरोध;
	पूर्ण
पूर्ण

अटल पूर्णांक sd_s_ctrl(काष्ठा v4l2_ctrl *ctrl)
अणु
	काष्ठा gspca_dev *gspca_dev =
		container_of(ctrl->handler, काष्ठा gspca_dev, ctrl_handler);
	काष्ठा sd *sd = (काष्ठा sd *)gspca_dev;

	gspca_dev->usb_err = 0;

	अगर (!gspca_dev->streaming)
		वापस 0;

	चयन (ctrl->id) अणु
	/* standalone gain control */
	हाल V4L2_CID_GAIN:
		set_gain(gspca_dev, ctrl->val);
		अवरोध;
	/* स्वतःgain */
	हाल V4L2_CID_AUTOGAIN:
		set_gain(gspca_dev, sd->gain->val);
		अवरोध;
	पूर्ण
	वापस gspca_dev->usb_err;
पूर्ण

अटल स्थिर काष्ठा v4l2_ctrl_ops sd_ctrl_ops = अणु
	.s_ctrl = sd_s_ctrl,
पूर्ण;


अटल पूर्णांक sd_init_controls(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा v4l2_ctrl_handler *hdl = &gspca_dev->ctrl_handler;
	काष्ठा sd *sd = (काष्ठा sd *)gspca_dev;

	gspca_dev->vdev.ctrl_handler = hdl;
	v4l2_ctrl_handler_init(hdl, 2);

	चयन (sd->model) अणु
	हाल 0x7003:
		sd->gain = v4l2_ctrl_new_std(hdl, &sd_ctrl_ops,
			V4L2_CID_GAIN, 0, 20, 1, 0);
		sd->स्वतःgain = v4l2_ctrl_new_std(hdl, &sd_ctrl_ops,
			V4L2_CID_AUTOGAIN, 0, 1, 1, 1);
		अवरोध;
	शेष:
		अवरोध;
	पूर्ण

	वापस 0;
पूर्ण
अटल पूर्णांक start_spy_cam(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा init_command spy_start_commands[] = अणु
		अणुअणु0x0c, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x20, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x21, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x22, 0x01, 0x04, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x23, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x24, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 4पूर्ण, /* width  352 */
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 4पूर्ण, /* height 288 */
		/* अणुअणु0x13, 0x27, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण, */
		अणुअणु0x13, 0x27, 0x01, 0x68, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण, /* red gain ?*/
		/* अणुअणु0x13, 0x28, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, */
		अणुअणु0x13, 0x29, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* अणुअणु0x13, 0x29, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण, */
		अणुअणु0x13, 0x2a, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण, */
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* अणुअणु0x13, 0x2e, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण, */
		अणुअणु0x13, 0x2e, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x07, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x12, 0x34, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x34, 0x01, 0xa1, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x35, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x02, 0x06, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x03, 0x13, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, /*करोn't mess with*/
		/*अणुअणु0x11, 0x04, 0x06, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, observed */
		अणुअणु0x11, 0x04, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, /* brighter */
		/*अणुअणु0x11, 0x05, 0x65, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, observed */
		अणुअणु0x11, 0x05, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, /* brighter */
		अणुअणु0x11, 0x06, 0xb1, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, /* observed */
		अणुअणु0x11, 0x07, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		/*अणुअणु0x11, 0x08, 0x06, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, observed */
		अणुअणु0x11, 0x08, 0x0b, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x09, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0a, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0c, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0d, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0e, 0x04, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* अणुअणु0x11, 0x0f, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, */
		/* brightness or gain. 0 is शेष. 4 is good
		 * inकरोors at night with incandescent lighting */
		अणुअणु0x11, 0x0f, 0x04, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x06, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण, /*hstart or hoffs*/
		अणुअणु0x11, 0x11, 0x06, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x14, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* अणुअणु0x1b, 0x02, 0x06, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण, observed */
		अणुअणु0x1b, 0x02, 0x11, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण, /* brighter */
		/* अणुअणु0x1b, 0x13, 0x01, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण, observed */
		अणुअणु0x1b, 0x13, 0x11, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x34, 0xa1, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण, /* compresses */
		/* Camera should start to capture now. */
	पूर्ण;

	वापस run_start_commands(gspca_dev, spy_start_commands,
				  ARRAY_SIZE(spy_start_commands));
पूर्ण

अटल पूर्णांक start_cअगर_cam(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा init_command cअगर_start_commands[] = अणु
		अणुअणु0x0c, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* The entire sequence below seems redundant */
		/* अणुअणु0x13, 0x20, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x21, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x22, 0x01, 0x06, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x23, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x24, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 4पूर्ण, width?
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 4पूर्ण, height?
		अणुअणु0x13, 0x27, 0x01, 0x68, 0x00, 0x00पूर्ण, 4पूर्ण, subsample?
		अणुअणु0x13, 0x28, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2a, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x0f, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x12, 0x34, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x34, 0x01, 0xa1, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x35, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,*/
		अणुअणु0x1b, 0x21, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x17, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x19, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x02, 0x06, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x03, 0x5a, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x04, 0x27, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x05, 0x01, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x12, 0x14, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x13, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x14, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x15, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x16, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x77, 0xa2, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x06, 0x0f, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x07, 0x14, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x08, 0x0f, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x09, 0x10, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x0e, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x0f, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x12, 0x07, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x10, 0x1f, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x11, 0x01, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 1पूर्ण, /* width/8 */
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 1पूर्ण, /* height/8 */
		/* अणुअणु0x13, 0x27, 0x01, 0x68, 0x00, 0x00पूर्ण, 4पूर्ण, subsample?
		 * अणुअणु0x13, 0x28, 0x01, 0x1e, 0x00, 0x00पूर्ण, 4पूर्ण, करोes nothing
		 * अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण, */
		/* अणुअणु0x13, 0x29, 0x01, 0x22, 0x00, 0x00पूर्ण, 4पूर्ण,
		 * causes subsampling
		 * but not a change in the resolution setting! */
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x01, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x08, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x06, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1b, 0x04, 0x6d, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x05, 0x03, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x36, 0x06, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x0e, 0x01, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x12, 0x27, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1b, 0x0f, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x36, 0x05, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x10, 0x0f, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x02, 0x06, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x11, 0x01, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x34, 0xa1, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,/* use compression */
		/* Camera should start to capture now. */
	पूर्ण;

	वापस run_start_commands(gspca_dev, cअगर_start_commands,
				  ARRAY_SIZE(cअगर_start_commands));
पूर्ण

अटल पूर्णांक start_ms350_cam(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा init_command ms350_start_commands[] = अणु
		अणुअणु0x0c, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x16, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x20, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x21, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x22, 0x01, 0x04, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x23, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x24, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2a, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x0f, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x12, 0x34, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x34, 0x01, 0xa1, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x35, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x00, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x01, 0x70, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x02, 0x05, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x03, 0x5d, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x04, 0x07, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x05, 0x25, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x06, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x07, 0x09, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x08, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x09, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0a, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0c, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0d, 0x0c, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0e, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x0f, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x63, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x15, 0x70, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x18, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण, /* width  */
		अणुअणु0x13, 0x26, 0x01, 0x1e, 0x00, 0x00पूर्ण, 4पूर्ण, /* height */
		अणुअणु0x13, 0x28, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण, /* vstart? */
		अणुअणु0x13, 0x27, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x40, 0x00, 0x00पूर्ण, 4पूर्ण, /* hstart? */
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x0f, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1b, 0x02, 0x05, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x11, 0x01, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x18, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x02, 0x0a, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x11, 0x01, 0x00, 0x00, 0x00पूर्ण, 0पूर्ण,
		/* Camera should start to capture now. */
	पूर्ण;

	वापस run_start_commands(gspca_dev, ms350_start_commands,
				  ARRAY_SIZE(ms350_start_commands));
पूर्ण

अटल पूर्णांक start_genius_cam(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा init_command genius_start_commands[] = अणु
		अणुअणु0x0c, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x16, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x10, 0x00, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* "preliminary" width and height settings */
		अणुअणु0x13, 0x28, 0x01, 0x0e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x22, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x07, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x20, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x21, 0x2d, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x22, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x23, 0x03, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x64, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x91, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x14, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x15, 0x20, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x16, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x17, 0x60, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x20, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x21, 0x2d, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x22, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x23, 0x03, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x25, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x26, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x27, 0x88, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x30, 0x38, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x31, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x32, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x33, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x34, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x5b, 0x0a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण, /* real width */
		अणुअणु0x13, 0x26, 0x01, 0x1e, 0x00, 0x00पूर्ण, 4पूर्ण, /* real height */
		अणुअणु0x13, 0x28, 0x01, 0x0e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x62, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x0f, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x20, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x21, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x22, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x23, 0x28, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x04, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x03, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x14, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x15, 0xe0, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x16, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x17, 0x80, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1c, 0x20, 0x00, 0x2a, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1c, 0x20, 0x00, 0x2a, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x34, 0xa1, 0x00, 0x00, 0x00पूर्ण, 0पूर्ण
		/* Camera should start to capture now. */
	पूर्ण;

	वापस run_start_commands(gspca_dev, genius_start_commands,
				  ARRAY_SIZE(genius_start_commands));
पूर्ण

अटल पूर्णांक start_genius_videocam_live(काष्ठा gspca_dev *gspca_dev)
अणु
	पूर्णांक r;
	काष्ठा sd *sd = (काष्ठा sd *) gspca_dev;
	काष्ठा init_command genius_vcam_live_start_commands[] = अणु
		अणुअणु0x0c, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 0पूर्ण,
		अणुअणु0x16, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x10, 0x00, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 4पूर्ण,

		अणुअणु0x13, 0x28, 0x01, 0x0e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x22, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x07, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x20, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x21, 0x2d, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x22, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x23, 0x03, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x64, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x91, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x14, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x15, 0x20, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x16, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x17, 0x60, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1c, 0x20, 0x00, 0x2d, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x20, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x21, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x22, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x23, 0x01, 0x01, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x24, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x16, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x12, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x0e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x22, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2a, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x09, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x07, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x12, 0x34, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x34, 0x01, 0xa1, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x35, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x01, 0x04, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x02, 0x92, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x64, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x91, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x14, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x15, 0x20, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x16, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x17, 0x60, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x20, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x21, 0x2d, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x22, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x23, 0x03, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x25, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x26, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x27, 0x88, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x30, 0x38, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x31, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x32, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x33, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x34, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x5b, 0x0a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x1e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x0e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x29, 0x01, 0x62, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x0f, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x20, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x21, 0x2a, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x22, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x23, 0x28, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x10, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x11, 0x04, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x12, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x13, 0x03, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x14, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x15, 0xe0, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x16, 0x02, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x11, 0x17, 0x80, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1c, 0x20, 0x00, 0x2a, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x34, 0xa1, 0x00, 0x00, 0x00पूर्ण, 0पूर्ण,
		/* Camera should start to capture now. */
		अणुअणु0x12, 0x27, 0x01, 0x00, 0x00, 0x00पूर्ण, 0पूर्ण,
		अणुअणु0x1b, 0x32, 0x26, 0x00, 0x00, 0x00पूर्ण, 0पूर्ण,
		अणुअणु0x1d, 0x25, 0x10, 0x20, 0xab, 0x00पूर्ण, 0पूर्ण,
	पूर्ण;

	r = run_start_commands(gspca_dev, genius_vcam_live_start_commands,
				  ARRAY_SIZE(genius_vcam_live_start_commands));
	अगर (r < 0)
		वापस r;

	अगर (sd->gain)
		set_gain(gspca_dev, v4l2_ctrl_g_ctrl(sd->gain));

	वापस r;
पूर्ण

अटल पूर्णांक start_vivitar_cam(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा init_command vivitar_start_commands[] = अणु
		अणुअणु0x0c, 0x01, 0x00, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x20, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x21, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x22, 0x01, 0x01, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x23, 0x01, 0x01, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x24, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x25, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x1e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x27, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x0a, 0x00, 0x00पूर्ण, 4पूर्ण,
		/*
		 * Above is changed from OEM 0x0b. Fixes Bayer tiling.
		 * Presumably gives a vertical shअगरt of one row.
		 */
		अणुअणु0x13, 0x29, 0x01, 0x20, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* Above seems to करो horizontal shअगरt. */
		अणुअणु0x13, 0x2a, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2b, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2c, 0x01, 0x02, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2d, 0x01, 0x03, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2e, 0x01, 0x0f, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x2f, 0x01, 0x0c, 0x00, 0x00पूर्ण, 4पूर्ण,
		/* Above three commands seem to relate to brightness. */
		अणुअणु0x12, 0x34, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x34, 0x01, 0xa1, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x35, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1b, 0x12, 0x80, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x01, 0x77, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x02, 0x3a, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x12, 0x78, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x13, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x14, 0x80, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x15, 0x34, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x1b, 0x04, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x20, 0x44, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x23, 0xee, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x26, 0xa0, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x27, 0x9a, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x28, 0xa0, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x29, 0x30, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x2a, 0x80, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x2b, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x2f, 0x3d, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x30, 0x24, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x32, 0x86, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x60, 0xa9, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x61, 0x42, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x65, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x69, 0x38, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x6f, 0x88, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x70, 0x0b, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x71, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x74, 0x21, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x75, 0x86, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x76, 0x00, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x7d, 0xf3, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x17, 0x1c, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x18, 0xc0, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x19, 0x05, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x1a, 0xf6, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		/* अणुअणु0x13, 0x25, 0x01, 0x28, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x26, 0x01, 0x1e, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x13, 0x28, 0x01, 0x0b, 0x00, 0x00पूर्ण, 4पूर्ण, */
		अणुअणु0x20, 0x36, 0x06, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x10, 0x26, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x12, 0x27, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x1b, 0x76, 0x03, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x36, 0x05, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x1b, 0x00, 0x3f, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		/* Above is brightness; OEM driver setting is 0x10 */
		अणुअणु0x12, 0x27, 0x01, 0x00, 0x00, 0x00पूर्ण, 4पूर्ण,
		अणुअणु0x20, 0x29, 0x30, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण,
		अणुअणु0x20, 0x34, 0xa1, 0x00, 0x00, 0x00पूर्ण, 1पूर्ण
	पूर्ण;

	वापस run_start_commands(gspca_dev, vivitar_start_commands,
				  ARRAY_SIZE(vivitar_start_commands));
पूर्ण

अटल पूर्णांक sd_start(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा sd *sd = (काष्ठा sd *) gspca_dev;
	पूर्णांक err_code;

	sd->sof_पढ़ो = 0;

	चयन (sd->model) अणु
	हाल 0x7005:
		err_code = start_genius_cam(gspca_dev);
		अवरोध;
	हाल 0x7003:
		err_code = start_genius_videocam_live(gspca_dev);
		अवरोध;
	हाल 0x8001:
		err_code = start_spy_cam(gspca_dev);
		अवरोध;
	हाल 0x8003:
		err_code = start_cअगर_cam(gspca_dev);
		अवरोध;
	हाल 0x8008:
		err_code = start_ms350_cam(gspca_dev);
		अवरोध;
	हाल 0x800a:
		err_code = start_vivitar_cam(gspca_dev);
		अवरोध;
	शेष:
		pr_err("Starting unknown camera, please report this\n");
		वापस -ENXIO;
	पूर्ण

	sd->avg_lum = -1;

	वापस err_code;
पूर्ण

अटल व्योम sd_stopN(काष्ठा gspca_dev *gspca_dev)
अणु
	पूर्णांक result;
	__u8 data[6];

	result = sn9c2028_पढ़ो1(gspca_dev);
	अगर (result < 0)
		gspca_err(gspca_dev, "Camera Stop read failed\n");

	स_रखो(data, 0, 6);
	data[0] = 0x14;
	result = sn9c2028_command(gspca_dev, data);
	अगर (result < 0)
		gspca_err(gspca_dev, "Camera Stop command failed\n");
पूर्ण

अटल व्योम करो_स्वतःgain(काष्ठा gspca_dev *gspca_dev, पूर्णांक avg_lum)
अणु
	काष्ठा sd *sd = (काष्ठा sd *) gspca_dev;
	s32 cur_gain = v4l2_ctrl_g_ctrl(sd->gain);

	अगर (avg_lum == -1)
		वापस;

	अगर (avg_lum < MIN_AVG_LUM) अणु
		अगर (cur_gain == sd->gain->maximum)
			वापस;
		cur_gain++;
		v4l2_ctrl_s_ctrl(sd->gain, cur_gain);
	पूर्ण
	अगर (avg_lum > MAX_AVG_LUM) अणु
		अगर (cur_gain == sd->gain->minimum)
			वापस;
		cur_gain--;
		v4l2_ctrl_s_ctrl(sd->gain, cur_gain);
	पूर्ण

पूर्ण

अटल व्योम sd_dqcallback(काष्ठा gspca_dev *gspca_dev)
अणु
	काष्ठा sd *sd = (काष्ठा sd *) gspca_dev;

	अगर (sd->स्वतःgain == शून्य || !v4l2_ctrl_g_ctrl(sd->स्वतःgain))
		वापस;

	करो_स्वतःgain(gspca_dev, sd->avg_lum);
पूर्ण

/* Include sn9c2028 sof detection functions */
#समावेश "sn9c2028.h"

अटल व्योम sd_pkt_scan(काष्ठा gspca_dev *gspca_dev,
			__u8 *data,			/* isoc packet */
			पूर्णांक len)			/* iso packet length */
अणु
	अचिन्हित अक्षर *sof;

	sof = sn9c2028_find_sof(gspca_dev, data, len);
	अगर (sof) अणु
		पूर्णांक n;

		/* finish decoding current frame */
		n = sof - data;
		अगर (n > माप sn9c2028_sof_marker)
			n -= माप sn9c2028_sof_marker;
		अन्यथा
			n = 0;
		gspca_frame_add(gspca_dev, LAST_PACKET, data, n);
		/* Start next frame. */
		gspca_frame_add(gspca_dev, FIRST_PACKET,
			sn9c2028_sof_marker, माप sn9c2028_sof_marker);
		len -= sof - data;
		data = sof;
	पूर्ण
	gspca_frame_add(gspca_dev, INTER_PACKET, data, len);
पूर्ण

/* sub-driver description */
अटल स्थिर काष्ठा sd_desc sd_desc = अणु
	.name = MODULE_NAME,
	.config = sd_config,
	.init = sd_init,
	.init_controls = sd_init_controls,
	.start = sd_start,
	.stopN = sd_stopN,
	.dq_callback = sd_dqcallback,
	.pkt_scan = sd_pkt_scan,
पूर्ण;

/* -- module initialisation -- */
अटल स्थिर काष्ठा usb_device_id device_table[] = अणु
	अणुUSB_DEVICE(0x0458, 0x7005)पूर्ण, /* Genius Smart 300, version 2 */
	अणुUSB_DEVICE(0x0458, 0x7003)पूर्ण, /* Genius Videocam Live v2  */
	/* The Genius Smart is untested. I can't find an owner ! */
	/* अणुUSB_DEVICE(0x0c45, 0x8000)पूर्ण, DC31VC, Don't know this camera */
	अणुUSB_DEVICE(0x0c45, 0x8001)पूर्ण, /* Wild Planet digital spy cam */
	अणुUSB_DEVICE(0x0c45, 0x8003)पूर्ण, /* Several small CIF cameras */
	/* अणुUSB_DEVICE(0x0c45, 0x8006)पूर्ण, Unknown VGA camera */
	अणुUSB_DEVICE(0x0c45, 0x8008)पूर्ण, /* Mini-Shotz ms-350 */
	अणुUSB_DEVICE(0x0c45, 0x800a)पूर्ण, /* Vivicam 3350B */
	अणुपूर्ण
पूर्ण;
MODULE_DEVICE_TABLE(usb, device_table);

/* -- device connect -- */
अटल पूर्णांक sd_probe(काष्ठा usb_पूर्णांकerface *पूर्णांकf,
			स्थिर काष्ठा usb_device_id *id)
अणु
	वापस gspca_dev_probe(पूर्णांकf, id, &sd_desc, माप(काष्ठा sd),
			       THIS_MODULE);
पूर्ण

अटल काष्ठा usb_driver sd_driver = अणु
	.name = MODULE_NAME,
	.id_table = device_table,
	.probe = sd_probe,
	.disconnect = gspca_disconnect,
#अगर_घोषित CONFIG_PM
	.suspend = gspca_suspend,
	.resume = gspca_resume,
	.reset_resume = gspca_resume,
#पूर्ण_अगर
पूर्ण;

module_usb_driver(sd_driver);
