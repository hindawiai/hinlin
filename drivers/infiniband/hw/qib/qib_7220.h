<शैली गुरु>
#अगर_अघोषित _QIB_7220_H
#घोषणा _QIB_7220_H
/*
 * Copyright (c) 2007, 2009, 2010 QLogic Corporation. All rights reserved.
 *
 * This software is available to you under a choice of one of two
 * licenses.  You may choose to be licensed under the terms of the GNU
 * General Public License (GPL) Version 2, available from the file
 * COPYING in the मुख्य directory of this source tree, or the
 * OpenIB.org BSD license below:
 *
 *     Redistribution and use in source and binary क्रमms, with or
 *     without modअगरication, are permitted provided that the following
 *     conditions are met:
 *
 *      - Redistributions of source code must retain the above
 *        copyright notice, this list of conditions and the following
 *        disclaimer.
 *
 *      - Redistributions in binary क्रमm must reproduce the above
 *        copyright notice, this list of conditions and the following
 *        disclaimer in the करोcumentation and/or other materials
 *        provided with the distribution.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
 * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
 * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

/* grab रेजिस्टर-defs स्वतः-generated by HW */
#समावेश "qib_7220_regs.h"

/* The number of eager receive TIDs क्रम context zero. */
#घोषणा IBA7220_KRCVEGRCNT      2048U

#घोषणा IB_7220_LT_STATE_CFGRCVFCFG      0x09
#घोषणा IB_7220_LT_STATE_CFGWAITRMT      0x0a
#घोषणा IB_7220_LT_STATE_TXREVLANES      0x0d
#घोषणा IB_7220_LT_STATE_CFGENH          0x10

काष्ठा qib_chip_specअगरic अणु
	u64 __iomem *cregbase;
	u64 *cntrs;
	u64 *portcntrs;
	spinlock_t sdepb_lock; /* serdes EPB bus */
	spinlock_t rcvmod_lock; /* protect rcvctrl shaकरोw changes */
	spinlock_t gpio_lock; /* RMW of shaकरोws/regs क्रम ExtCtrl and GPIO */
	u64 hwerrmask;
	u64 errormask;
	u64 gpio_out; /* shaकरोw of kr_gpio_out, क्रम rmw ops */
	u64 gpio_mask; /* shaकरोw the gpio mask रेजिस्टर */
	u64 extctrl; /* shaकरोw the gpio output enable, etc... */
	u32 ncntrs;
	u32 nportcntrs;
	u32 cntrnamelen;
	u32 portcntrnamelen;
	u32 numctxts;
	u32 rcvegrcnt;
	u32 स्वतःneg_tries;
	u32 serdes_first_init_करोne;
	u32 sdmabufcnt;
	u32 lastbuf_क्रम_pio;
	u32 updthresh; /* current AvailUpdThld */
	u32 updthresh_dflt; /* शेष AvailUpdThld */
	u8 presets_needed;
	u8 relock_समयr_active;
	अक्षर emsgbuf[128];
	अक्षर sdmamsgbuf[192];
	अक्षर bitsmsgbuf[64];
	काष्ठा समयr_list relock_समयr;
	अचिन्हित पूर्णांक relock_पूर्णांकerval; /* in jअगरfies */
	काष्ठा qib_devdata *dd;
पूर्ण;

काष्ठा qib_chippport_specअगरic अणु
	काष्ठा qib_pportdata pportdata;
	रुको_queue_head_t स्वतःneg_रुको;
	काष्ठा delayed_work स्वतःneg_work;
	काष्ठा समयr_list chase_समयr;
	/*
	 * these 5 fields are used to establish deltas क्रम IB symbol
	 * errors and linkrecovery errors.  They can be reported on
	 * some chips during link negotiation prior to INIT, and with
	 * DDR when faking DDR negotiations with non-IBTA चयनes.
	 * The chip counters are adjusted at driver unload अगर there is
	 * a non-zero delta.
	 */
	u64 ibdeltainprog;
	u64 ibsymdelta;
	u64 ibsymsnap;
	u64 iblnkerrdelta;
	u64 iblnkerrsnap;
	u64 ibcctrl; /* kr_ibcctrl shaकरोw */
	u64 ibcddrctrl; /* kr_ibcddrctrl shaकरोw */
	अचिन्हित दीर्घ chase_end;
	u32 last_delay_mult;
पूर्ण;

/*
 * This header file provides the declarations and common definitions
 * क्रम (mostly) manipulation of the SerDes blocks within the IBA7220.
 * the functions declared should only be called from within other
 * 7220-related files such as qib_iba7220.c or qib_sd7220.c.
 */
पूर्णांक qib_sd7220_presets(काष्ठा qib_devdata *dd);
पूर्णांक qib_sd7220_init(काष्ठा qib_devdata *dd);
व्योम qib_sd7220_clr_ibpar(काष्ठा qib_devdata *);
/*
 * Below used क्रम sdnum parameter, selecting one of the two sections
 * used क्रम PCIe, or the single SerDes used क्रम IB, which is the
 * only one currently used
 */
#घोषणा IB_7220_SERDES 2

अटल अंतरभूत u32 qib_पढ़ो_kreg32(स्थिर काष्ठा qib_devdata *dd,
				  स्थिर u16 regno)
अणु
	अगर (!dd->kregbase || !(dd->flags & QIB_PRESENT))
		वापस -1;
	वापस पढ़ोl((u32 __iomem *)&dd->kregbase[regno]);
पूर्ण

अटल अंतरभूत u64 qib_पढ़ो_kreg64(स्थिर काष्ठा qib_devdata *dd,
				  स्थिर u16 regno)
अणु
	अगर (!dd->kregbase || !(dd->flags & QIB_PRESENT))
		वापस -1;

	वापस पढ़ोq(&dd->kregbase[regno]);
पूर्ण

अटल अंतरभूत व्योम qib_ग_लिखो_kreg(स्थिर काष्ठा qib_devdata *dd,
				  स्थिर u16 regno, u64 value)
अणु
	अगर (dd->kregbase)
		ग_लिखोq(value, &dd->kregbase[regno]);
पूर्ण

व्योम set_7220_relock_poll(काष्ठा qib_devdata *, पूर्णांक);
व्योम shutकरोwn_7220_relock_poll(काष्ठा qib_devdata *);
व्योम toggle_7220_rclkrls(काष्ठा qib_devdata *);


#पूर्ण_अगर /* _QIB_7220_H */
